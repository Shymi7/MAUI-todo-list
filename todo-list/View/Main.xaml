<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:todo_list.ViewModel"
             x:Class="todo_list.View.Main">

    <StackLayout Padding="10">

        <ListView ItemsSource="{Binding Source={RelativeSource AncestorType={x:Type local:MainVM}}, Path=CurrentTasks.List }"  HasUnevenRows="True">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <StackLayout Orientation="Vertical" Padding="10">
                            <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold" />
                            <Label Text="{Binding Description}" FontSize="14" />
                            <Label Text="{Binding Created, StringFormat='Created: {0:g}'}" FontSize="12" TextColor="Gray" />

                            <StackLayout Orientation="Horizontal" HorizontalOptions="End">
                                <Button Text="Delete" 
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:MainVM}}, Path=DeleteTaskCommand}"
                                        CommandParameter="{Binding Id}"
                                        BackgroundColor="Red"
                                        TextColor="White"
                                        WidthRequest="80" />

                                <Button Text="Finish" 
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:MainVM}}, Path=MarkTaskAsCompletedCommand}"
                                        CommandParameter="{Binding Id}"
                                        BackgroundColor="Green"
                                        TextColor="White"
                                        WidthRequest="80"
                                        Margin="10,0,0,0" />
                            </StackLayout>
                        </StackLayout>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>


        <ListView ItemsSource="{Binding Source={RelativeSource AncestorType={x:Type local:MainVM}}, Path=FinishedTasks.List }"  HasUnevenRows="True">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <StackLayout Orientation="Vertical" Padding="10">
                            <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold" />
                            <Label Text="{Binding Description}" FontSize="14" />
                            <Label Text="{Binding Created, StringFormat='Created: {0:g}'}" FontSize="12" TextColor="Gray" />

                            <StackLayout Orientation="Horizontal" HorizontalOptions="End">
                                <Button Text="Delete" 
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type local:MainVM}}, Path=DeleteTaskCommand}"
                                        CommandParameter="{Binding Id}"
                                        BackgroundColor="Red"
                                        TextColor="White"
                                        WidthRequest="80" />
                            </StackLayout>
                        </StackLayout>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <StackLayout Orientation="Vertical" Spacing="10" Margin="0,20,0,0">
            <Entry Placeholder="Enter Title" Text="{Binding NewTaskTitle}" />
            <Entry Placeholder="Enter Description" Text="{Binding NewTaskDescription}" />
            <Button Text="Add Task" 
                    Command="{Binding AddTaskCommand}"
                    BackgroundColor="Blue"
                    TextColor="White" />
        </StackLayout>

    </StackLayout>

</ContentView>